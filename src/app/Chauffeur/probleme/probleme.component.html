<div class="report-container">
  <h2>üö® Signaler un Probl√®me</h2>

  <form [formGroup]="problemForm" (ngSubmit)="submitProblem()">
    <div class="form-group">
      <label for="deliveryId">Livraison *</label>
      <select 
        id="deliveryId"
        formControlName="deliveryId"
        [disabled]="loadingDeliveries">
        <option value="">-- S√©lectionner une livraison --</option>
        <option *ngFor="let delivery of myDeliveries" [value]="delivery.id">
          {{ getDeliveryDescription(delivery) }}
        </option>
      </select>
      <small *ngIf="currentRole === 'DRIVER' && !loadingDeliveries && myDeliveries.length === 0" class="help-text">
        Aucune livraison active disponible. Vous ne pouvez signaler un probl√®me que pour vos livraisons en cours.
      </small>
      <small *ngIf="loadingDeliveries" class="help-text">Chargement des livraisons...</small>
      <small *ngIf="currentRole === 'CLIENT'" class="help-text">
        Entrez l'ID de la livraison concern√©e
      </small>
    </div>

    <div class="form-group" *ngIf="currentRole === 'CLIENT'">
      <label for="deliveryIdInput">ID Livraison *</label>
      <input 
        id="deliveryIdInput"
        formControlName="deliveryId" 
        type="number" 
        placeholder="Ex: 12">
    </div>

    <div class="form-group">
      <label for="type">Type de probl√®me *</label>
      <select id="type" formControlName="type">
        <option value="">-- S√©lectionner un type --</option>
        <option *ngFor="let t of problemTypes" [value]="t">
          {{ getTypeLabel(t) }}
        </option>
      </select>
    </div>

    <div class="form-group">
      <label for="description">Description *</label>
      <textarea 
        id="description"
        formControlName="description" 
        placeholder="D√©crivez le probl√®me en d√©tail (minimum 10 caract√®res)..."
        rows="5"></textarea>
      <small class="help-text">
        Minimum 10 caract√®res requis. Soyez aussi pr√©cis que possible.
      </small>
    </div>

    <button 
      type="submit" 
      [disabled]="problemForm.invalid || loading"
      class="submit-btn">
      <span *ngIf="!loading">üö® Envoyer le signalement</span>
      <span *ngIf="loading">Envoi en cours...</span>
    </button>
  </form>

  <div class="success" *ngIf="successMessage">{{ successMessage }}</div>
  <div class="error" *ngIf="errorMessage">{{ errorMessage }}</div>
</div>
